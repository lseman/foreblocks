<svg xmlns="http://www.w3.org/2000/svg" width="1800" height="1250" viewBox="0 0 1800 1250" style="background:#FCFCFD;">
  <defs>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="1" stdDeviation="2" flood-color="#000" flood-opacity="0.08"/>
    </filter>
    <marker id="arrow" viewBox="0 0 10 10" refX="8.5" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#CBD5E1" />
    </marker>
  </defs>

  <g>
    <text x="36" y="30" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="28" font-weight="800" fill="#0B1020">Feature Engineering Pipeline</text>
    <text x="36" y="60" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#475569">Pastel scientific style • with math notation and improved spacing</text>
  </g>
<rect x="36" y="120" width="1728" height="110" rx="14" fill="#F8FAFC" stroke="#CBD5E1" opacity="0.7"/><text x="48" y="146" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#334155" font-weight="700">Ingestion &amp; Type Inference</text><rect x="36" y="280" width="1728" height="240" rx="14" fill="#F9FAFB" stroke="#CBD5E1" opacity="0.7"/><text x="48" y="306" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#334155" font-weight="700">Numerical Path</text><rect x="36" y="570" width="1728" height="200" rx="14" fill="#F8FAFC" stroke="#CBD5E1" opacity="0.7"/><text x="48" y="596" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#334155" font-weight="700">Categorical Path</text><rect x="36" y="820" width="1728" height="130" rx="14" fill="#F9FAFB" stroke="#CBD5E1" opacity="0.7"/><text x="48" y="846" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#334155" font-weight="700">Boolean Path</text><rect x="36" y="1000" width="1728" height="120" rx="14" fill="#F8FAFC" stroke="#CBD5E1" opacity="0.7"/><text x="48" y="1026" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#334155" font-weight="700">Selection • Scaling • Output</text><rect x="52" y="156" width="310" height="96" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="68" y="180" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Input Data X, y</text><text x="68" y="196" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">X ∈ ℝ^{n×p}, y ∈ ℝ^{n}</text><text x="68" y="214" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">NaNs and mixed dtypes handled</text><rect x="410" y="156" width="310" height="96" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="426" y="180" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Type Inference</text><text x="426" y="196" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">numerical / categorical / datetime / boolean</text><text x="426" y="214" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">robust dtype detection</text><line x1="362" y1="204.0" x2="410" y2="204.0" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="768" y1="204.0" x2="784" y2="204.0" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><path d="M 784 204.0 L 784 270" fill="none" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><path d="M 784 204.0 L 784 560" fill="none" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><path d="M 784 204.0 L 784 810" fill="none" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><rect x="52" y="316" width="310" height="120" rx="14" fill="#E0F2FE" stroke="#CBD5E1" filter="url(#shadow)"/><text x="68" y="340" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Math Transforms</text><text x="68" y="356" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">log(x+1), √x, 1/x</text><text x="68" y="374" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">cyclical time encodings</text><text x="68" y="392" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">domain-safe guards</text><rect x="410" y="316" width="310" height="120" rx="14" fill="#EDE9FE" stroke="#CBD5E1" filter="url(#shadow)"/><text x="426" y="340" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Smart Interactions</text><text x="426" y="356" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">x+y, x·y, x/y, x−y, x²</text><text x="426" y="374" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">XGBoost screening</text><text x="426" y="392" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">≤ 50 features</text><rect x="768" y="316" width="310" height="120" rx="14" fill="#FEF3C7" stroke="#CBD5E1" filter="url(#shadow)"/><text x="784" y="340" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Adaptive Binning</text><text x="784" y="356" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">KBins (quantile, B=5)</text><text x="784" y="374" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">skip constant/ill-posed</text><rect x="52" y="468" width="310" height="112" rx="14" fill="#CCFBF1" stroke="#CBD5E1" filter="url(#shadow)"/><text x="68" y="492" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Clustering (KMeans)</text><text x="68" y="508" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">variance-ranked features</text><text x="68" y="526" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">cluster_id, dist_min, dist_mean</text><rect x="410" y="468" width="310" height="112" rx="14" fill="#FEF9C3" stroke="#CBD5E1" filter="url(#shadow)"/><text x="426" y="492" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Row-wise Statistics</text><text x="426" y="508" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">mean, std, min, max, median, range, skew</text><text x="426" y="526" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">nonnull count, null ratio</text><rect x="768" y="468" width="310" height="112" rx="14" fill="#FCE7F3" stroke="#CBD5E1" filter="url(#shadow)"/><text x="784" y="492" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Fourier Features</text><text x="784" y="508" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">FFT → top-|X(f)|</text><text x="784" y="526" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">sin(2πft), cos(2πft)</text><line x1="362" y1="376" x2="410" y2="376" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="720" y1="376" x2="768" y2="376" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="207.0" y1="436" x2="207.0" y2="468" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="565.0" y1="436" x2="565.0" y2="468" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="923.0" y1="436" x2="923.0" y2="468" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><rect x="1126" y="316" width="310" height="120" rx="14" fill="#F1F5F9" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="1142" y="340" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Corr Removal</text><text x="1142" y="356" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">|corr(xᵢ,xⱼ)|&gt;τ ⇒ drop lower var</text><text x="1142" y="374" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">τ = 0.95</text><line x1="1078" y1="376" x2="1126" y2="376" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><rect x="1484" y="316" width="310" height="120" rx="14" fill="#FAE8FF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="1500" y="340" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Imputation</text><text x="1500" y="356" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">median/mean/mode by skew</text><text x="1500" y="374" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">per-feature</text><line x1="1436" y1="376" x2="1484" y2="376" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><rect x="1842" y="316" width="310" height="120" rx="14" fill="#E2F7F0" stroke="#CBD5E1" filter="url(#shadow)"/><text x="1858" y="340" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Scaling</text><text x="1858" y="356" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">QuantileTransformer → 𝒩(0,1)</text><text x="1858" y="374" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">fallback: standardize</text><line x1="1794" y1="376" x2="1842" y2="376" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><rect x="1842" y="464" width="310" height="96" rx="14" fill="#FFE4E6" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="1858" y="488" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" font-weight="800" fill="#0F172A">Autoencoder Latents z</text><text x="1858" y="498" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="11" fill="#475569">MaskedTabAE, d_token, heads</text><text x="1858" y="516" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="11" fill="#475569">z ∈ ℝ^k</text><path d="M 1997.0 436 L 1997.0 464" fill="none" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><rect x="52" y="606" width="310" height="106" rx="14" fill="#DCFCE7" stroke="#CBD5E1" filter="url(#shadow)"/><text x="68" y="630" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Rare Category Handling</text><text x="68" y="646" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">p&lt;1% → OTHER</text><text x="68" y="664" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">mode imputation</text><rect x="410" y="606" width="310" height="106" rx="14" fill="#ECFCCB" stroke="#CBD5E1" filter="url(#shadow)"/><text x="426" y="630" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Target Encoding</text><text x="426" y="646" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">μ_c = (n_c·ȳ_c + α·ȳ)/(n_c+α)</text><text x="426" y="664" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">high-card only</text><rect x="768" y="606" width="310" height="106" rx="14" fill="#E5E7EB" stroke="#CBD5E1" filter="url(#shadow)"/><text x="784" y="630" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">One-Hot Encoding</text><text x="784" y="646" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">ignore unknown</text><text x="784" y="664" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">drop if binary</text><rect x="1126" y="606" width="310" height="106" rx="14" fill="#FFF7ED" stroke="#CBD5E1" filter="url(#shadow)"/><text x="1142" y="630" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Frequency Encoding</text><text x="1142" y="646" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">p(x=c) per feature</text><line x1="362" y1="659" x2="410" y2="659" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="720" y1="659" x2="768" y2="659" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="1078" y1="659" x2="1126" y2="659" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><rect x="52" y="856" width="310" height="96" rx="14" fill="#F1F5F9" stroke="#CBD5E1" filter="url(#shadow)"/><text x="68" y="880" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Boolean Handling</text><text x="68" y="896" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">fillna(mode) → {0,1}</text><rect x="52" y="1030" width="310" height="100" rx="14" fill="#E0E7FF" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="68" y="1054" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">AdaptiveMI</text><text x="68" y="1070" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">I(x; y) adaptive estimator</text><text x="68" y="1088" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">keep MI &gt; 10⁻³</text><rect x="410" y="1030" width="310" height="100" rx="14" fill="#E9D5FF" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="426" y="1054" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">SHAP Pruning</text><text x="426" y="1070" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">mean |ϕ_j| &gt; θ</text><text x="426" y="1088" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">θ = 10⁻³</text><rect x="768" y="1030" width="420" height="100" rx="14" fill="#F8FAFC" stroke="#CBD5E1" filter="url(#shadow)"/><text x="784" y="1054" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Concatenate Selected Features</text><text x="784" y="1070" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">numerical + z + categorical + boolean → X_final</text><rect x="1236" y="1030" width="310" height="100" rx="14" fill="#F0FDFA" stroke="#CBD5E1" filter="url(#shadow)"/><text x="1252" y="1054" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="15" font-weight="800" fill="#0F172A">Output</text><text x="1252" y="1070" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">X_final ∈ ℝ^{n×d}</text><text x="1252" y="1088" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">clean • encoded • scaled</text><line x1="1997.0" y1="560" x2="207.0" y2="1080" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="1436" y1="659" x2="768" y2="1080" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="362" y1="904" x2="768" y2="1080" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="362" y1="1080" x2="410" y2="1080" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="720" y1="1080" x2="768" y2="1080" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><line x1="1188" y1="1080" x2="1236" y2="1080" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><g transform="translate(1364,26)"><rect x="0" y="0" width="380" height="108" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="14" y="24" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="13" font-weight="800" fill="#0F172A">Legend</text><rect x="14" y="34" width="28" height="14" rx="4" fill="#E0F2FE" stroke="#CBD5E1"/><text x="50" y="46" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">Block (category-colored)</text><rect x="14" y="56" width="28" height="14" rx="4" fill="#FFF" stroke="#CBD5E1" stroke-dasharray="6,6"/><text x="50" y="68" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">Dashed = optional/conditional</text><line x1="14" y1="84" x2="42" y2="84" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><text x="50" y="88" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#475569">Arrow = feature/data flow</text></g></svg>