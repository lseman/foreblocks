<svg xmlns="http://www.w3.org/2000/svg" width="1420" height="1250" viewBox="0 0 1420 1250" style="background:#F8FAFC;">
  <defs>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="1" stdDeviation="2" flood-color="#000000" flood-opacity="0.08"/>
    </filter>
    <marker id="arrow" viewBox="0 0 10 10" refX="8.5" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#CBD5E1" />
    </marker>
  </defs>

  <g>
    <text x="32" y="30" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="26" font-weight="700" fill="#0F172A">Feature Engineering Pipeline (2025+)</text>
    <text x="32" y="58" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#94A3B8">Pedagogical diagram • enriched with modern SOTA blocks</text>
  </g>
<rect x="32" y="110" width="1356" height="130" rx="14" fill="#F7F7F8" stroke="#CBD5E1" opacity="0.5"/><text x="44" y="134" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#374151" font-weight="600">Ingestion &amp; Type Inference</text><rect x="32" y="250" width="1356" height="435" rx="14" fill="#F3F4F6" stroke="#CBD5E1" opacity="0.5"/><text x="44" y="274" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#374151" font-weight="600">Numerical Path</text><rect x="32" y="700" width="1356" height="150" rx="14" fill="#F5F7FA" stroke="#CBD5E1" opacity="0.5"/><text x="44" y="724" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#374151" font-weight="600">Categorical Path</text><rect x="32" y="880" width="1356" height="140" rx="14" fill="#F7F7F8" stroke="#CBD5E1" opacity="0.5"/><text x="44" y="904" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#374151" font-weight="600">Boolean Path</text><rect x="32" y="1040" width="1356" height="140" rx="14" fill="#F3F4F6" stroke="#CBD5E1" opacity="0.5"/><text x="44" y="1064" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" fill="#374151" font-weight="600">Selection • Scaling • Output</text><rect x="44" y="142" width="280" height="90" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="58" y="164" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Input Data X, y</text><text x="58" y="178" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">• X ∈ ℝ^{n×p}, y ∈ ℝ^n</text><text x="58" y="194" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">• mixed dtypes, NaNs handled</text><rect x="360" y="142" width="280" height="90" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="374" y="164" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Type Inference</text><text x="374" y="178" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">• detect {ℝ, Cat, Bool, Time}</text><text x="374" y="194" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">• robust dtype + datetime parsing</text><line x1="324" y1="187.0" x2="360" y2="187.0" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><rect x="44" y="282" width="280" height="120" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="58" y="304" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Math Transforms</text><text x="58" y="318" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">log, √, 1/x, Box-Cox/Yeo-Johnson</text><text x="58" y="334" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">cyclical encodings (sin, cos)</text><rect x="360" y="282" width="280" height="120" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="374" y="304" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Smart Interactions</text><text x="374" y="318" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">poly {x², x·y}, ratios, diffs</text><text x="374" y="334" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">HSIC / MI gating, ≤50 kept</text><rect x="676" y="282" width="280" height="120" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="690" y="304" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Adaptive Binning</text><text x="690" y="318" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">Bayesian blocks, FD rule, SS bins</text><text x="690" y="334" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">auto choice by data entropy</text><rect x="44" y="430" width="280" height="110" rx="14" fill="#FFFFFF" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="58" y="452" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Clustering Features</text><text x="58" y="466" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">KMeans/GMM cluster id</text><text x="58" y="482" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">distances, silhouette scores</text><rect x="250" y="420" rx="8" ry="8" width="64" height="22" fill="#F8FAFC" stroke="#9CA3AF"/><text x="282" y="436" text-anchor="middle" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="11" fill="#9CA3AF" font-weight="600">optional</text><rect x="360" y="430" width="280" height="110" rx="14" fill="#FFFFFF" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="374" y="452" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Row-wise Stats</text><text x="374" y="466" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">μ, σ, min, max, median, skew</text><text x="374" y="482" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">nonnull count, null ratio</text><rect x="566" y="420" rx="8" ry="8" width="64" height="22" fill="#F8FAFC" stroke="#9CA3AF"/><text x="598" y="436" text-anchor="middle" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="11" fill="#9CA3AF" font-weight="600">optional</text><rect x="676" y="430" width="280" height="110" rx="14" fill="#FFFFFF" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="690" y="452" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Fourier &amp; Wavelet</text><text x="690" y="466" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">FFT |X(f)| top-k</text><text x="690" y="482" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">DWT: multi-resolution coeffs</text><rect x="882" y="420" rx="8" ry="8" width="64" height="22" fill="#F8FAFC" stroke="#9CA3AF"/><text x="914" y="436" text-anchor="middle" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="11" fill="#9CA3AF" font-weight="600">optional</text><rect x="44" y="568" width="280" height="100" rx="14" fill="#FFFFFF" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="58" y="590" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Graph Features</text><text x="58" y="604" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">kNN/corr-graph Laplacian</text><text x="58" y="620" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">node2vec / GCN embeddings</text><rect x="250" y="558" rx="8" ry="8" width="64" height="22" fill="#F8FAFC" stroke="#9CA3AF"/><text x="282" y="574" text-anchor="middle" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="11" fill="#9CA3AF" font-weight="600">optional</text><rect x="360" y="568" width="280" height="100" rx="14" fill="#FFFFFF" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="374" y="590" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Drift Aware</text><text x="374" y="604" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">KS/PSI tests train vs test</text><text x="374" y="620" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">drop unstable features</text><rect x="566" y="558" rx="8" ry="8" width="64" height="22" fill="#F8FAFC" stroke="#9CA3AF"/><text x="598" y="574" text-anchor="middle" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="11" fill="#9CA3AF" font-weight="600">optional</text><rect x="44" y="732" width="280" height="100" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="58" y="754" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Rare Category Handling</text><text x="58" y="768" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">p &lt; 1% → OTHER</text><text x="58" y="784" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">mode fill</text><rect x="360" y="732" width="280" height="100" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="374" y="754" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Target Encoding</text><text x="374" y="768" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">μ_c = (n_c·ȳ_c + α·ȳ)/(n_c+α)</text><text x="374" y="784" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">regularized smoothing</text><rect x="676" y="732" width="280" height="100" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="690" y="754" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">One-Hot Encoding</text><text x="690" y="768" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">ignore unknown</text><text x="690" y="784" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">drop binary</text><rect x="992" y="732" width="280" height="100" rx="14" fill="#FFFFFF" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="1006" y="754" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Embedding Models</text><text x="1006" y="768" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">tab-transformer, cat2vec</text><text x="1006" y="784" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">LLM embeddings for text cats</text><rect x="1198" y="722" rx="8" ry="8" width="64" height="22" fill="#F8FAFC" stroke="#9CA3AF"/><text x="1230" y="738" text-anchor="middle" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="11" fill="#9CA3AF" font-weight="600">optional</text><rect x="44" y="912" width="280" height="88" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="58" y="934" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Boolean Handling</text><text x="58" y="948" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">fillna(mode) → {0,1}</text><rect x="44" y="1068" width="280" height="92" rx="14" fill="#FFFFFF" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="58" y="1090" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Adaptive MI</text><text x="58" y="1104" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">MI(x;y) adaptive KSG/Copula</text><text x="58" y="1120" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">retain MI &gt; 10⁻³</text><rect x="360" y="1068" width="280" height="92" rx="14" fill="#FFFFFF" stroke="#CBD5E1" stroke-dasharray="6,6" filter="url(#shadow)"/><text x="374" y="1090" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">SHAP Pruning</text><text x="374" y="1104" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">mean |ϕ_j| &gt; θ (θ≈10⁻³)</text><rect x="676" y="1068" width="380" height="92" rx="14" fill="#E5E7EB" stroke="#CBD5E1" filter="url(#shadow)"/><text x="690" y="1090" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Concatenate</text><text x="690" y="1104" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">numerical + z + categorical + boolean</text><text x="690" y="1120" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">→ X_final ∈ ℝ^{n×d}</text><rect x="1092" y="1068" width="280" height="92" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="1106" y="1090" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="14" font-weight="700" fill="#111827">Output</text><text x="1106" y="1104" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">Clean, encoded, scaled matrix</text><text x="1106" y="1120" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">ready for ML pipeline</text><g transform="translate(988,30)"><rect x="0" y="0" width="380" height="100" rx="14" fill="#FFFFFF" stroke="#CBD5E1" filter="url(#shadow)"/><text x="14" y="22" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="13" font-weight="700" fill="#111827">Legend</text><rect x="14" y="30" width="28" height="14" rx="4" fill="#FFFFFF" stroke="#CBD5E1"/><text x="50" y="41" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">Solid block</text><rect x="14" y="50" width="28" height="14" rx="4" fill="#FFFFFF" stroke="#9CA3AF" stroke-dasharray="6,6"/><text x="50" y="61" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">Dashed block (optional/SOTA)</text><line x1="14" y1="78" x2="42" y2="78" stroke="#CBD5E1" stroke-width="2" marker-end="url(#arrow)"/><text x="50" y="82" font-family="Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, sans-serif" font-size="12" fill="#374151">Arrow — data flow</text></g></svg>